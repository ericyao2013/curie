#/bin/sh

rm -f benchmark-*

./benchmarks/configure

for i in $(find ./benchmarks -name "posix-*" -a ! \( -type d -o \( -name '*.c' -o -name '*.o' \) \) ); do
    echo $i
    time $@ $i

    if [ "$?" != "0" ]; then
        echo " * $i failed (code $?)";
    fi
done

for i in $(find ./benchmarks -name "atomic-*" -a ! \( -type d -o \( -name '*.c' -o -name '*.o' \) \) ); do
    echo $i
    time $@ $i

    if [ "$?" != "0" ]; then
        echo " * $i failed (code $?)";
    fi
done

